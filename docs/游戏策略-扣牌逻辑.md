# 五人三副牌找朋友升级 - 扣牌策略

## 核心策略:尽可能把最短的一门扣绝

### 策略原理

**目标**: 扣掉最短的副牌花色,形成缺门,这样在出牌时可以:
1. 用主牌毙掉该花色
2. 避免在该花色上被对手甩牌
3. 增加牌型灵活性

### 扣牌优先级(从高到低)

```
1. 扣绝最短的副牌门(非主牌花色)
   - 如果某门副牌只有1-3张,优先全部扣掉
   - 形成缺门后可以用主牌毙牌

2. 扣掉零散的单张小牌
   - 非分牌(非5、10、K)
   - 无法组成对子或三张的孤牌
   - 点数小(2、3、4、6、7、8、9)

3. 避免扣掉的牌:
   ❌ 主牌(主花色的牌)
   ❌ 级牌(当前打的等级)
   ❌ 分牌(5、10、K)
   ❌ 能组成对子或三张的牌
   ❌ 大牌(A、K、Q、J)

4. 保留的牌:
   ✅ 所有主牌花色
   ✅ 所有级牌
   ✅ 对子、三张等牌型
   ✅ 分牌(尤其是10和K)
   ✅ 大王、小王
```

### 具体扣牌算法

```
步骤1: 统计各门花色的牌数
  - 主花色: X张
  - 副花色1: Y1张
  - 副花色2: Y2张
  - 副花色3: Y3张

步骤2: 找出最短的副牌门
  - 排除主牌花色
  - 找到牌数最少的副花色

步骤3: 如果最短门≤6张
  - 优先扣绝这一门
  - 选择该门中的非分牌、小牌

步骤4: 如果最短门>6张
  - 从各门中选择零散的小单张
  - 优先顺序: 2 < 3 < 4 < 6 < 7 < 8 < 9
```

### 示例场景

**场景1: 打2级,主牌红桃**

手牌分布:
- 红桃(主): 12张
- 黑桃: 8张
- 梅花: 3张 ← 最短门
- 方片: 15张

扣牌策略:
```
优先扣绝梅花(3张):
1. 梅花3 (非分牌,小牌)
2. 梅花7 (非分牌,小牌)
3. 梅花8 (非分牌,小牌)

如果梅花有分牌,则:
- 先扣其他门的小单张
- 尽量保留梅花的分牌
```

**场景2: 打5级,主牌黑桃**

手牌分布:
- 黑桃(主): 15张
- 红桃: 2张 ← 最短门,且有分牌
- 梅花: 10张
- 方片: 11张

手牌详细:
- 红桃: 10(分牌)、J

扣牌策略:
```
不扣红桃10(是分牌),改扣其他门的零散小牌:
1. 梅花2
2. 梅花3
3. 方片2
4. 方片3
5. 方片6
6. 方片7
7. 黑桃9(如果是单张且非主牌核心)
```

### 特殊情况处理

#### 情况1: 所有副牌门都很均匀(都是7-10张)
```
策略: 扣掉各门的零散小单张
- 优先扣非分牌
- 优先扣无法组成牌型的牌
- 保留对子和三张
```

#### 情况2: 手里有多张大王小王
```
策略: 优先扣副牌小牌
- 王牌必须保留(最大的主牌)
- 多扣副牌,为用王毙牌留空间
```

#### 情况3: 某门有很多分牌
```
策略: 即使这门最短,也不要扣绝
- 分牌决定升级,必须保留
- 扣其他门的小牌
```

### 实现要点

```javascript
function autoDiscardBottomCards(myHand, trumpSuit, trumpRank) {
    // 1. 统计各门牌数
    const suitCount = {
        hearts: [],
        diamonds: [],
        clubs: [],
        spades: []
    };

    // 2. 对牌进行分类
    myHand.forEach(card => {
        if (card.suit !== 'joker') {
            suitCount[card.suit].push(card);
        }
    });

    // 3. 找出非主牌的最短门
    let shortestSuit = null;
    let shortestCount = 999;

    for (let suit in suitCount) {
        if (suit !== trumpSuit && suitCount[suit].length < shortestCount) {
            shortestCount = suitCount[suit].length;
            shortestSuit = suit;
        }
    }

    // 4. 优先从最短门选择非分牌
    const toDiscard = [];

    if (shortestSuit && shortestCount <= 6) {
        // 从最短门选择非分牌、小牌
        const shortestCards = suitCount[shortestSuit]
            .filter(c => c.value !== trumpRank && !isPointCard(c))
            .sort((a, b) => getCardValue(a) - getCardValue(b));

        toDiscard.push(...shortestCards.slice(0, 7));
    }

    // 5. 如果不够7张,补充其他门的小单张
    if (toDiscard.length < 7) {
        // ... 补充逻辑
    }

    return toDiscard.slice(0, 7);
}

function isPointCard(card) {
    return card.rank === '5' || card.rank === '10' || card.rank === 'K';
}
```

### 进阶技巧

1. **根据叫朋友策略调整**
   - 如果打算叫某门的牌,不要扣绝那门
   - 给自己留出找朋友的选择空间

2. **考虑抠底风险**
   - 不要扣太多分牌在底牌
   - 如果被抠底,分牌会翻倍

3. **平衡手牌结构**
   - 保留牌型(对子、三张、拖拉机)
   - 扣掉破坏牌型的单张

---

**记住**: 扣牌是升级游戏最重要的策略之一,好的扣牌可以让后续出牌更加灵活!

**核心口诀**:
- 扣绝最短门
- 保留分和主
- 避扣对和三
- 散牌优先去
